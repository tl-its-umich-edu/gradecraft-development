
.small-12.panel.mainContent

  = content_nav_for @badge
  
  .small-12.medium-9
    %h3.pagetitle= @title

  .small-12.medium-3.right.columns
    .button-bar.right
      %ul.button-group.context_menu
        %li
          %a{:href => edit_badge_path(@badge) }
            %i.fi-pencil
            Edit
        %li
          %a{:href => new_badge_earned_badge_path(:badge_id => @badge) }
            %i.fi-results
            Award
        %li
          %a{:href => mass_award_badge_path(@badge) }
            %i.fi-results-demographics
            Quick Award

  .small-12.columns
    //badge icon, total awarded, and points
    .panel.small-12.medium-2.columns.text-center
      %img{:src => @badge.icon, :alt => @badge.name, :width => "100" }
      %hr
        .center
          %b Awarded:
          .label.round.bold.large=@badge.awarded_count
          
      - if @badge.point_total?
        %hr
        .center
          %b Point Value:
          ="#{@badge.point_total}"
          
      - if @badge.description?
        %p
          %b Description:
          = raw @badge.description

      - if @badge.badge_files.present?
        %p
          %b Attachments:
          %ul
            - @badge.badge_files.each do |bf|
              %li
                = link_to bf.filename, bf.url
                - if current_user.is_staff?
                  = link_to "(Remove)", remove_uploads_path({ :model => "BadgeFile", :upload_id => bf.id } )

    - if current_user.is_staff?

      .small-12.medium-10.columns.responsive
        //staff individual badge award index
        %table.responsive.nofeatures_default_last_name_dynatable
          %thead
            %tr
              %th First Name
              %th Last Name
              %th{ :width => 300} Feedback
              - if @badge.can_earn_multiple_times  
                %th Count
              %th{"data-dynatable-sorts" => "dateStamp"} Date Awarded
              %th{:style => "display: none"} Date Stamp
          %tbody
            - if @team
              - students = current_course_data.students_for_team(@team)
            - else
              - students = current_course_data.students
            - students.each do |student|
              %tr
                %td=link_to student.first_name, student_path(student)
                %td= link_to student.last_name, student_path(student)
                %td{ :width => 80}
                  - @badge.earned_badges.where(:student_id => student.id).each do |badge|
                    = raw badge.feedback
                - if @badge.can_earn_multiple_times
                  %td= @badge.earned_badge_count_for_student(student)
                
                %td  
                  - @badge.earned_badges.where(:student_id => student.id).each do |badge|
                    %img{:src => @badge.icon, :alt => @badge.name, :width => "20" }
                    %span.has-tip{:title => "Edit this #{term_for :badge}", :data => {'tooltip' => true} }= link_to "(#{badge.created_at.strftime("%b %d")})", edit_badge_earned_badge_path(@badge, badge.id)
                    %span
                      = link_to badge_earned_badge_path(@badge, badge), :method => :delete, :data => { confirm: "Are you sure you want to delete this #{term_for :badge}?" } do
                        %i.fi-trash
                    .clearfix